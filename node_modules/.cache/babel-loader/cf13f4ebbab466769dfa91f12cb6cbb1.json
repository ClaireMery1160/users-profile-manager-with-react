{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\c_mer\\\\OneDrive\\\\Documents\\\\Actiris\\\\candidatures\\\\2021\\\\juin21\\\\Besedo\\\\sauvegardes\\\\backup1\\\\react-profiles-app\\\\src\\\\components\\\\user-form.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport formatType from '../helpers/format-type';\nimport { useHistory } from 'react-router-dom';\nimport UserService from '../services/user-service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UserForm = ({\n  user\n}) => {\n  _s();\n\n  const [form, setForm] = useState({\n    firstname: {\n      value: user.firstname,\n      isValid: true\n    },\n    lastname: {\n      value: user.lastname,\n      isValid: true\n    },\n    types: {\n      value: user.types,\n      isValid: true\n    }\n  });\n  const types = ['Direction', 'IT', 'Finance', 'Production', 'Human Ressources'];\n\n  const hasType = type => {\n    return form.types.value.includes(type);\n  };\n\n  const history = useHistory();\n\n  const handleInputChange = e => {\n    const fieldName = e.target.name;\n    const fieldValue = e.target.value;\n    const newField = {\n      [fieldName]: {\n        value: fieldValue\n      }\n    };\n    setForm({ ...form,\n      ...newField\n    });\n  };\n\n  const selectType = (type, e) => {\n    const checked = e.target.checked;\n    let newField;\n\n    if (checked) {\n      const newTypes = form.types.value.concat([type]);\n      newField = {\n        value: newTypes\n      };\n    } else {\n      const newTypes = form.types.value.filter(currentType => currentType !== type);\n      newField = {\n        value: newTypes\n      };\n    }\n\n    setForm({ ...form,\n      ...{\n        types: newField\n      }\n    });\n  };\n\n  const validateForm = () => {\n    let newForm = form;\n\n    if (!/^[a-zA-Zàéèêëç-]{1,25}$/.test(form.firstname.value)) {\n      const errorMsg = ' Le prénom de l\\'utilisateur est requis et doit faire max 25 caractères.';\n      const newField = {\n        value: form.firstname.value,\n        error: errorMsg,\n        isValid: false\n      };\n      newForm = { ...newForm,\n        ...{\n          firstname: newField\n        }\n      };\n    } else {\n      const newField = {\n        value: form.firstname.value,\n        error: '',\n        isValid: true\n      };\n      newForm = { ...newForm,\n        ...{\n          firstname: newField\n        }\n      };\n    }\n\n    if (!/^[a-zA-Zàéèêëç-]{1,25}$/.test(form.lastname.value)) {\n      const errorMsg = ' Le nom de l\\'utilisateur est requis et doit faire max 25 caractères.';\n      const newField = {\n        value: form.lastname.value,\n        error: errorMsg,\n        isValid: false\n      };\n      newForm = { ...newForm,\n        ...{\n          lastname: newField\n        }\n      };\n    } else {\n      const newField = {\n        value: form.firstname.value,\n        error: '',\n        isValid: true\n      };\n      newForm = { ...newForm,\n        ...{\n          lastname: newField\n        }\n      };\n    }\n\n    setForm(newForm);\n    return newForm.firstname.isValid && newForm.lastname.isValid;\n  };\n\n  const isTypesValid = type => {\n    if (form.types.value.length === 1 && hasType(type)) {\n      return false;\n    }\n\n    if (form.types.value.length >= 2 && !hasType(type)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault(); // console.log(form);\n\n    const isFormValid = validateForm();\n\n    if (isFormValid) {\n      user.firstname = form.firstname.value;\n      user.lastname = form.lastname.value;\n      user.types = form.types.value;\n      UserService.updateUser(user).then(() => history.push(`/users/${user.id}`));\n    }\n  };\n\n  const deleteUser = () => {\n    UserService.deleteUser(user).then(() => history.push(`/users`));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: e => handleSubmit(e),\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col s12 m8 offset-m2\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card hoverable\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-image\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: user.picture,\n              alt: user.lastname,\n              style: {\n                width: '250px',\n                margin: '0 auto'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"btn-floating halfway-fab waves-effect wave-light\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                onClick: deleteUser,\n                className: \"material-icons\",\n                children: \"delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 82\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-stacked\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"\",\n                  children: \"Pr\\xE9nom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"firstname\",\n                  name: \"firstname\",\n                  type: \"text\",\n                  className: \"form-control\",\n                  value: form.firstname.value,\n                  onChange: e => handleInputChange(e)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 19\n                }, this), form.firstname.error && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"card-panel red accent-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"material-icons text-red\",\n                    children: \"error\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 85\n                  }, this), form.firstname.error]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 44\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"hp\",\n                  children: \"Nom\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"lastname\",\n                  name: \"lastname\",\n                  type: \"text\",\n                  className: \"form-control\",\n                  value: form.lastname.value,\n                  onChange: e => handleInputChange(e)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 137,\n                  columnNumber: 19\n                }, this), form.lastname.error && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"card-panel red accent-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"material-icons text-red\",\n                    children: \"error\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 84\n                  }, this), form.lastname.error]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 43\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Types\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 143,\n                  columnNumber: 19\n                }, this), types.map(type => /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginBottom: '10px'\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"label\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      id: type,\n                      name: \"type\",\n                      type: \"checkbox\",\n                      className: \"filled-in\",\n                      value: type,\n                      checked: hasType(type),\n                      onChange: e => selectType(type, e),\n                      disabled: !isTypesValid(type)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 147,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: formatType(type),\n                        children: type\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 149,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 148,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 23\n                  }, this)\n                }, type, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 21\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-action center\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"btn\",\n                children: \"Valider\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserForm, \"aVXQcth/+XmAgxWFd+Q8jfqwqag=\", false, function () {\n  return [useHistory];\n});\n\n_c = UserForm;\nexport default UserForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserForm\");","map":{"version":3,"sources":["C:/Users/c_mer/OneDrive/Documents/Actiris/candidatures/2021/juin21/Besedo/sauvegardes/backup1/react-profiles-app/src/components/user-form.tsx"],"names":["React","useState","formatType","useHistory","UserService","UserForm","user","form","setForm","firstname","value","isValid","lastname","types","hasType","type","includes","history","handleInputChange","e","fieldName","target","name","fieldValue","newField","selectType","checked","newTypes","concat","filter","currentType","validateForm","newForm","test","errorMsg","error","isTypesValid","length","handleSubmit","preventDefault","isFormValid","updateUser","then","push","id","deleteUser","picture","width","margin","map","marginBottom"],"mappings":"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","sourcesContent":["import React, { FunctionComponent, useState } from 'react';\r\nimport User from '../models/user';\r\nimport formatType from '../helpers/format-type';\r\nimport { useHistory } from 'react-router-dom';  \r\nimport UserService from '../services/user-service';\r\n\r\ntype Props = {\r\n  user: User\r\n};\r\n\r\ntype Field = {\r\n    value?: any,\r\n    error?: string,\r\n    isValid?: boolean\r\n};\r\n\r\ntype Form = {\r\n    firstname: Field,\r\n    lastname: Field,\r\n    types: Field\r\n};\r\n  \r\nconst UserForm: FunctionComponent<Props> = ({user}) => {\r\n\r\n    const[form, setForm] = useState<Form>({\r\n        firstname: {value: user.firstname, isValid: true},\r\n        lastname: {value: user.lastname, isValid: true},\r\n        types: {value: user.types, isValid: true}\r\n    });\r\n  \r\n    const types: string[] = ['Direction', 'IT', 'Finance', 'Production', 'Human Ressources'];\r\n\r\n    const hasType = (type: string): boolean => {\r\n        return form.types.value.includes(type);\r\n    }\r\n\r\n    const history = useHistory();\r\n\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>):void => {\r\n        const fieldName: string = e.target.name;\r\n        const fieldValue: string = e.target.value;\r\n        const newField: Field = { [fieldName]: { value: fieldValue } };\r\n\r\n        setForm( {...form, ...newField} );\r\n    }\r\n\r\n    const selectType = (type: string, e: React.ChangeEvent<HTMLInputElement>): void => {\r\n        const checked = e.target.checked;\r\n        let newField: Field;\r\n\r\n        if(checked){\r\n            const newTypes: string[] = form.types.value.concat([type]);\r\n            newField = { value: newTypes };\r\n        }else{\r\n            const newTypes: string[] = form.types.value.filter((currentType: string) => currentType !== type);\r\n            newField = {value: newTypes };\r\n        }\r\n\r\n        setForm({...form, ...{ types: newField }});\r\n    }\r\n\r\n    const validateForm = () => {\r\n      let newForm: Form = form;\r\n\r\n      if(!/^[a-zA-Zàéèêëç-]{1,25}$/.test(form.firstname.value)) {\r\n        const errorMsg: string = ' Le prénom de l\\'utilisateur est requis et doit faire max 25 caractères.';\r\n        const newField: Field = { value: form.firstname.value, error: errorMsg, isValid: false };\r\n        newForm = { ...newForm, ...{ firstname: newField } };\r\n      } else {\r\n        const newField: Field = { value: form.firstname.value, error: '', isValid: true };\r\n        newForm = { ...newForm, ...{ firstname: newField } };\r\n      }\r\n\r\n      if(!/^[a-zA-Zàéèêëç-]{1,25}$/.test(form.lastname.value)) {\r\n        const errorMsg: string = ' Le nom de l\\'utilisateur est requis et doit faire max 25 caractères.';\r\n        const newField: Field = { value: form.lastname.value, error: errorMsg, isValid: false };\r\n        newForm = { ...newForm, ...{ lastname: newField } };\r\n      } else {\r\n        const newField: Field = { value: form.firstname.value, error: '', isValid: true };\r\n        newForm = { ...newForm, ...{ lastname: newField } };\r\n      }\r\n    \r\n      setForm(newForm);\r\n      return newForm.firstname.isValid && newForm.lastname.isValid;\r\n    }\r\n\r\n    const isTypesValid = (type: string): boolean => {\r\n\r\n      if (form.types.value.length === 1 && hasType(type)) {\r\n        return false;\r\n      }\r\n\r\n      if (form.types.value.length >= 2 && !hasType(type)) { \r\n        return false; \r\n      } \r\n\r\n      return true;\r\n    }\r\n\r\n    const handleSubmit = (e: React.FormEvent<HTMLFormElement>) =>{\r\n      e.preventDefault();\r\n      // console.log(form);\r\n      const isFormValid = validateForm();\r\n      if (isFormValid) { \r\n        user.firstname = form.firstname.value;\r\n        user.lastname = form.lastname.value;\r\n        user.types = form.types.value;\r\n        UserService.updateUser(user).then(() => history.push(`/users/${user.id}`)); \r\n      }      \r\n    }\r\n\r\n    const deleteUser = () => {\r\n      UserService.deleteUser(user).then(() => history.push(`/users`));\r\n    }\r\n\r\n\r\n  return (\r\n    <form onSubmit={ e => handleSubmit(e)}>\r\n      <div className=\"row\">\r\n        <div className=\"col s12 m8 offset-m2\">\r\n          <div className=\"card hoverable\"> \r\n            <div className=\"card-image\">\r\n              <img src={user.picture} alt={user.lastname} style={{width: '250px', margin: '0 auto'}}/>\r\n              <span className=\"btn-floating halfway-fab waves-effect wave-light\"><i onClick={deleteUser} className=\"material-icons\">delete</i></span>\r\n            </div>\r\n            <div className=\"card-stacked\">\r\n              <div className=\"card-content\">\r\n                {/* firstname */}\r\n                <div className=\"form-group\">               \r\n                  <label htmlFor=\"\">Prénom</label>\r\n                  <input id=\"firstname\" name=\"firstname\" type=\"text\" className=\"form-control\" value={form.firstname.value} onChange={e => handleInputChange(e)}></input>\r\n                  {form.firstname.error && <div className=\"card-panel red accent-1\"><i className=\"material-icons text-red\">error</i>{form.firstname.error}</div>}\r\n                </div>\r\n                {/*  lastname */}\r\n                <div className=\"form-group\">\r\n                  <label htmlFor=\"hp\">Nom</label>\r\n                  <input id=\"lastname\" name=\"lastname\" type=\"text\" className=\"form-control\" value={form.lastname.value} onChange={e => handleInputChange(e)}></input>\r\n                  {form.lastname.error && <div className=\"card-panel red accent-1\"><i className=\"material-icons text-red\">error</i>{form.lastname.error}</div>}\r\n                </div>\r\n\r\n                {/* types */}\r\n                <div className=\"form-group\"> \r\n                  <label>Types</label>\r\n                  {types.map(type => (\r\n                    <div key={type} style={{marginBottom: '10px'}}>\r\n                      <label>\r\n                        <input id={type} name=\"type\" type=\"checkbox\" className=\"filled-in\" value={type} checked={hasType(type)} onChange={ e => selectType(type, e)} disabled = {!isTypesValid(type)}></input>\r\n                        <span>\r\n                          <p className={formatType(type)}>{ type }</p>\r\n                        </span>\r\n                      </label>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              <div className=\"card-action center\">\r\n                {/* Submit button */}\r\n                <button type=\"submit\" className=\"btn\">Valider</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n   \r\nexport default UserForm;"]},"metadata":{},"sourceType":"module"}